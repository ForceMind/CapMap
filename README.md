# 沪深300市场回放系统（CapMap）

## 项目简介
本项目是一个基于 Streamlit 的 A股历史盘面回放与分时走势分析工具，支持沪深300成分股的历史热力图、分时走势拼接、板块过滤、指数对比等功能。

## 主要特性
- **历史热力图回放**：可通过滑块或日期选择器回看任意历史交易日的市场表现。
- **多日分时走势拼接**：支持自定义日期区间，自动去除节假日和午休时间，走势无缝衔接。
- **分时数据高效缓存**：分时数据按“股票+日期”自动缓存，极大提升多次访问速度。
- **板块过滤**：可一键排除创业板、科创板。
- **指数对比**：支持沪深300、上证指数、深证成指分时对比。
- **高权重影响力排序**：自动筛选对指数涨跌影响最大的个股。

## 快速启动
1. 安装依赖：
   ```bash
   pip install -r requirements.txt
   ```
2. 一键启动（推荐）：
   直接双击 `csi300_app/一键启动.bat`，或命令行运行：
   ```bash
   python csi300_app/app.py
   ```
3. 浏览器访问：
   默认会自动打开 Streamlit 页面，若未自动弹出，可手动访问 http://localhost:8501

## 目录结构
```
CapMap/
├── csi300_app/
│   ├── app.py              # 主程序
│   ├── 一键启动.bat        # Windows一键启动脚本
│   ├── ...                # 其它辅助文件
├── tests/                  # 测试代码（建议放置）
├── LICENSE
└── README.md
```

## 测试
- 所有测试代码请放入 `tests/` 文件夹。
- 示例：
  ```bash
  python tests/test_index_recent.py
  ```

## 依赖
- Python 3.9+
- Streamlit
- AkShare
- Plotly
- Pandas

## 常见问题
- **分时数据拉取慢/失败？**
  - 已实现自动重试与细粒度缓存，网络偶发问题可自动恢复。
- **多日拼接有空白？**
  - 系统会自动去除节假日和无数据日，拼接更自然。

## 许可证
本项目遵循 MIT License。
